# CI/CD

- What is CI/CD
  - Stands for Continuous Integration, Continuous Delivery / Deployment
  - Software development Best practice
  - Makes small changes and automate everthing - Small incremental code changes, Automate as much as possible ex- code integration, build, test and deployment
  - Why is it so Cool - Modern companies like - Amazon, Google, Facebook have pioneered this approach to releasing code, successfully applying thousands of changes per day
- Benefits of CI/CD Approach
  - Automatation is good - Fast, repeatable, scalable, enables rapid deployment
  - Manual is bad- Slow, error prone, inconsistent, unscalable, complex
  - small changes - test each code change and catch bugs while they are small and simple to fix
- Continuous Integration Workflow
  - Shared Code Repository: Multiple developers contributing to a shared code repo like GIT, frequently mergeing or integrating code updates
  - Automated Build: When changes appear in the code repo this triggers an automated build of the new code
  - Automated Test: Run automated test to check the code locally before it is committed into the master code repo
- Continuous Delivery & Deployment Workflow
  - Code is Merged : After successful tests, the code gets merged to the master repo
  - Prepared for Deployment: Code is built, tested and packaged for deployment
  - Manual Decision: Humans may be involved in the decision to deploy the code(Where and When to deploy). This is known as Continuous Delivery
  - Or Fully Automated: The system automatically deploys the new code as soon as it has been prepared for deployment. This is known as Continuous Deployment
- AWS Developer Tools
  - CodeCommit: (Source & Version Control) - Source control service enabling teams to collaborate on code, html pages, scripts, images and binaries [Like- Git]
  - CodeBuild : (Automated Build) - Compiles source code, runs tests and produces packages that are ready to deploy [Like- Actions]
  - CodeDeploy : (Automated Deployment) - Automates code deployments to any instance, including EC2, Lambda and on-premises [Like- webhook]
  - CodePipeline : (Manages the Workflow) - End-to-End solution, build, test and deploy your application every time there is a code change
- Exam Tips:
  - Continuous Integration - Integrating or merging the code changes frequently - at least once per day. Think CodeCommit
  - Continuous Delivery - Automating the build, test and deployment functions. Think CodeBuild and CodeDeploy
  - Continuous Deployment - Fully automated release process, code is deployed into Staging or Production as soon as it has successfully passed through the release pipeline. Think CodePipeline
- WHITE PAPER: https://d0.awsstatic.com/whitepapers/DevOps/practicing-continuous-integration-continuous-delivery-on-AWS.pdf

---

# CodeCommit

- [./assets/code-commit.png]
- Exam Tips:
  - Centralized Code Repo: A place to store your source code. Based on Git
  - Enables Collaboration: Manages updates from multiple users
  - Version Control: Tracks and manages code changes Maintains version history

---

# CodeDeploy

- Automated Deployment Service
- Works with EC2 instances, on-premises & Lambda
- Quick release new feature
- Avoid downtime during deployments
- Avoid the risks associated with manual processes
- Code deployments apporaches
  - In-Place:
    - The applications is stopped on each instance and the new release is installed. Also known as a rolling update
    - Steps:
      - The applications is stopped on the first instance
      - The instance will be out of service during the deployment so capcity is reduced.
      - You should configure your Elastic Load Balancer to stop sending the requests to the instance for which deployment is in go on( which is down )
      - CodeDeploy installs the new version, known as a Revision
      - The instance comes back into service
      - CodeDeploy continues to deploy to the next instance
    - How to Rollback in deployment process ?
      - If you change your mind, there's no quick fix
      - With an in-place deployment you'll need to re-deploy the previous version which can be time consuming
  - Blue/Green:
    - New instances are provisioned and the new release is intalled on the new instances. Blue represents the active deployment, green is the new release
    - Steps:
      - Blue represents the current version of our application
      - CodeDeploy provisions new instances
      - The new Revision is deployed to the Green environment
      - The Green instances are registered with the Elastic Load balancer
      - Traffic is routed away from the old environment
      - The Blue environment is eventually terminated
    - How to Rollback in deployment process in Blue/Green?
      - With Blue/Green, its easy
      - Just set the load balancer to direct the traffic back the original environment
      - Thus easy to swtich between the old and new releases
      - Only works if you didn't already termiate your old environment
- Difference b/w in-place and blue/green:
  - In-place:
    - Capacity is reduced during the deployment
    - Lambda is not supported
    - Rolling back involves a re-deploy
    - Great when deploying the first time
  - Blue/Green
    - No capcity reduction
    - Green instances can be created ahead of time
    - Easy to switch between old and new
    - You play for 2 environments untill you terminate the olde servers
- NOTE : Safest Option for code deployment in production environment is - Blue/Green approach
- Configure CodeDeploy using the AppSpec File
  - Configuration File: Defines the parameters to be used during a codeDeploy deployment
  - EC2: For EC2 and on-premises systems, YAML only
  - Lambda: YAML and JSON supported. File Structure depends on weather you are deploying to lambda or EC2
  - AppSpec file Structure:
    - Version: Reserved for future use- Current allowed version value is 0.0
    - OS: Operating System version- linux, windows
    - file: Configuring files, packages- The location of any applications files that need to be copied and where they should be copied to
    - hooks: Lifecycle event hooks- Scripts which need to run at set points in the deployment lifecycle. Hooks have a very specific run order
- Scripts You might run during the deployment process
  - Unzip Files: Unzip application files prior to deployment
  - Run Tests: Run functional tests on a newly deployed application
  - Deal with Load Balancing: De-register and re-register instances with a load balancer
  - [.assets/AppSec.png]
- NOTE: appspec.yml file must be placed at the root of the directory of your revision, otherwise the deployment will fail
- Exam Tips:
  - AppSpec is a Configuration File- Defines the parameter to be used by CodeDeply ex- OS, files, hooks
  - appspec.yml - Should be saved to the root of your revision
  - Hooks - Lifecycle events hooks have a very specific run order.
