# IAM

- Login to AWS Account
- Services > Security, Identity, & Compliance > IAM
- Here you can find IAM users sign-in link, to use console
- Security Status :
  - Activate MFA on your root account (Enable another layer of authentication)
  - Create Individual IAM users (Bcoz we dont want all of users login into AWS console with root account, this we need to restrict access and give them only required access)

---

# Creating group, roles, policies

## Activating MFA on root account

- Security Status > Activate MFA on your root Account > Manage MFA
- MFA > Activate MFA
- Select a type of MFA device to assign > Virtual MFA Device
- (Now to check the list of devices which supports MFA) > Google Authenticator > Add New > Scan barcode opens in Mobile
- In AWS website > Setup virtual MFA Device > Use your virtual MFA app and your device's camera to scan the QR code > (Scan QR Code)
- Type two consecutive MFA codes below
  - Type both the consecutive codes which is appearing on our Google Authenticator Mobile phone
- Assign Virtual MFA
- Goback to > https://console.aws.amazon.com/iam/home#/home

## Creating Individual IAM users

- Once u see the Green tick on Activate MFA on your root account.
- Users > Add user
- Username : Tom > Select AWS access type >(Check) Access type : Programmatic access , Access type : AWS Management Console access > console password : Autogenerated password > Require password reset : (Check)
- Next Permissions
- Create group
- Group Name : sysadmin
- (Select policy as) : Administrator Access
- Create Group
- Next Tags
- Create user

- (Thus user has been created with Access Key ID and Secret access key -> This will be needed if this users try to login using CLI/Console)
- (Secret access key Show be saved )

- Create Jerry User with same sysadmin Group as done for Tom

## Creating Group

- Groups
- Create new group
- Group Name : HR
- Policy Type : AmazonS3ReadOnlyAccess (Select) > Next Step
- Create Group

## Changing existing user to different group

- (Let us change Tom from sysadmin group to HR Group)
- Users Tab > (Click on) Tom
- Groups Tab
- Add user to groups
- (Select) HR > Add to Groups
- We can also delete Tom from sysadmin group

## Adding policies directly to user without him being in a particular group

- Users Tab > (Click on) Tom
- Permissions Tab > Add Permissions
- Attach existing policies directly
- Policies : AmazonGlacierFullAccess (Select)
- Next Review
- Add permissions

---

# Apply an IAM password policy

- (Basically set of rules which for passsword when an IAM users sets/changes his password)
- Manage Password Policy
- Password policy > Set Password policy
- Require at least one non-alphanumeric character (!@#\$%^&\*()\_+-=[]{}|')
- Enable password expiration Expire passwords in 90 day(s)
- Svae changes

---

# Creating Roles

- Roles Tab
- Create role
- AWS Service
- EC2
- Next permissions
- Policies : AmazonS3FullAccess (Select)
- Next Tags
- Next Reviews
- Role name : S3Access-EC2
- Create Role

---

# Cognito lab

- Services > Security, Identity, & Compliance > Cognito
- Manage User Pools
- Create a user pool
- Pool name: testpool
- Review defaults
- Create pool
- (pool is created successfully)
- App clients: (click) Add app client...
  - Add an app client
  - App client name: mytestclient
  - Create app client
- App Integration > App client settings (tab)
  - Enabled Identity Providers: (check) Cognito User Pool
  - Callback URL(s): https://example.com
  - OAuth 2.0
    - Allowed OAuth Flows : (check) -> Authorization code grant, Implicit grant
    - Allowed OAuth Scopes : (check) -> phone, email, openid, aws.cognito.signin.user.admin, profile
  - Save changes
- App Integration > Domain Name
  - Amazon Cognito domain: tsabunkar(domain prefix)
- UI customization
  - (add some logo)
- (click) App Integration
  - copy the Domain url : ttps://tsabunkar.auth.us-east-1.amazoncognito.com
  - (add suffix): https://tsabunkar.auth.us-east-1.amazoncognito.com/login?response_type=token&client_id=<client_id_value>&redirect_uri=<mentioned_callback_url>
  - <client_id_value> - App Integration > App client settings > ID 4vhtaa8ucupo3vuk86ibgqlvkj
  - https://tsabunkar.auth.us-east-1.amazoncognito.com/login?response_type=token&client_id=4vhtaa8ucupo3vuk86ibgqlvkj&redirect_uri=https://example.com
- Genral Settings > Users and Groups
  - (click) refresh icon
  - Groups (tab)
  - Create group
  - Name (Required): testgroup
  - Description: Test
  - IAM role: db-admin
  - (select) testgroup
    - Add users
    - (select) tsabunkar [User who sign-up]
  - Add to group: (select) testgroup
- Federation > Identity providers (you can see all 3rd party identity providers)
